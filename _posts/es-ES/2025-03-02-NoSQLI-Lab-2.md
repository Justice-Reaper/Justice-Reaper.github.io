---
title: Exploiting NoSQL operator injection to bypass authentication
description: Laboratorio de Portswigger sobre NoSQLI
date: 2025-03-02 12:26:00 +0800
lang: es-ES
author: Justice-Reaper
categories:
  - Portswigger Labs
  - NoSQLI
tags:
  - Portswigger Labs
  - NoSQLI
  - Exploiting NoSQL operator injection to bypass authentication
image:
  path: /assets/img/Portswigger/Portswigger.png
---

## Certificaciones

- eWPT
- eWPTXv2
- OSWE
- BSCP
  
## Descripción

Este `laboratorio` utiliza una `base de datos NoSQL` en `MongoDB` para `gestionar` la `funcionalidad` de `inicio de sesión`. Es `vulnerable` a `inyección NoSQL` mediante `operadores` de `MongoDB`. Para `resolver` el `laboratorio`, debemos `iniciar sesión` en la `aplicación` como el usuario `administrador`. Podemos `iniciar sesión` en nuestra propia cuenta utilizando las credenciales `wiener:peter`

---

## Guía de NoSQLI

`Antes` de `completar` este `laboratorio` es recomendable `leerse` esta `guía de NoSQLI` [https://justice-reaper.github.io/posts/NoSQLI-Guide/](https://justice-reaper.github.io/posts/NoSQLI-Guide/)

## Resolución

Al `acceder` a la `web` vemos esto

![](/assets/img/NoSQLI-Lab-2/image_1.png)

Pulsamos sobre `My account` y nos logueamos con las credenciales `wiener:peter`

![](/assets/img/NoSQLI-Lab-2/image_2.png)

Si capturamos la `petición` con `Burpsuite`, vemos que se está enviando un `JSON` con el `nombre de usuario` y la `contraseña`

![](/assets/img/NoSQLI-Lab-2/image_3.png)

`Modificamos` la `petición`, con el operador de consulta `$regex` seleccionamos todos los usuarios que empiezan por `adm` y en el campo `contraseña` usamos el operador `$ne` con el valor `null`, es decir, cuya `contraseña` tiene un valor distinto de `null`

![](/assets/img/NoSQLI-Lab-2/image_4.png)

Hacemos click derecho y pulsamos `Request in browser > In original session`

![](/assets/img/NoSQLI-Lab-2/image_5.png)

Nos `copiamos` el `enlace` y lo pegamos en el `navegador`. Una vez hecho eso, habremos accedido a la cuenta del `usuario administrador` efectuando un `login bypass`

![](/assets/img/NoSQLI-Lab-2/image_6.png)
